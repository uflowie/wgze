{{range .Foods}}
<div class="p-4 bg-white border border-gray-200 rounded-lg mb-3 shadow-sm hover:shadow-md transition-shadow" id="food-{{.ID}}">
    <div class="food-display">
        <div class="flex items-start justify-between">
            <div class="flex-1">
                <div class="text-lg font-semibold text-gray-800 mb-1">{{.Name}}</div>
                {{if .Notes}}
                <div class="text-sm text-gray-600 mb-1 whitespace-pre-wrap">{{.Notes}}</div>
                {{end}}
                <div class="text-sm">
                    {{if eq .DaysAgo -1}}
                        <span class="text-red-500 font-medium">Noch nie gegessen</span>
                    {{else if eq .DaysAgo 0}}
                        <span class="text-green-500 font-medium">Heute gegessen</span>
                    {{else if eq .DaysAgo 1}}
                        <span class="text-green-500 font-medium">Gestern gegessen</span>
                    {{else if le .DaysAgo 7}}
                        <span class="text-green-500 font-medium">Vor {{.DaysAgo}} Tagen gegessen</span>
                    {{else if le .DaysAgo 30}}
                        <span class="text-yellow-500 font-medium">Vor {{.DaysAgo}} Tagen gegessen</span>
                    {{else}}
                        <span class="text-red-500 font-medium">Vor {{.DaysAgo}} Tagen gegessen</span>
                    {{end}}
                </div>
            </div>
            <div class="flex gap-2 ml-4">
                <button class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium" 
                        onclick="toggleEdit({{.ID}})">
                    Bearbeiten
                </button>
                <button class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-medium" 
                        hx-delete="/delete-food/{{.ID}}" 
                        hx-target="#food-list" 
                        hx-swap="innerHTML"
                        hx-confirm="Sind Sie sicher, dass Sie diese Speise löschen möchten? Alle zugehörigen Mahlzeiten werden ebenfalls gelöscht!">
                    Löschen
                </button>
            </div>
        </div>
    </div>
    
    <div class="food-edit hidden">
        <form hx-post="/edit-food/{{.ID}}" hx-target="#food-list" hx-swap="innerHTML" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Name der Speise:</label>
                <input type="text" 
                       name="name" 
                       value="{{.Name}}"
                       required
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Anmerkungen / Rezept:</label>
                <textarea name="notes" 
                          rows="6"
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none resize-vertical">{{.Notes}}</textarea>
            </div>
            
            <div class="flex gap-2">
                <button type="submit" 
                        class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-medium">
                    Speichern
                </button>
                <button type="button" 
                        onclick="toggleEdit({{.ID}})"
                        class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm font-medium">
                    Abbrechen
                </button>
            </div>
        </form>
    </div>
</div>
{{else}}
<div class="text-center py-12 text-gray-500">
    <div class="text-lg mb-2">Noch keine Speisen hinzugefügt</div>
    <div class="text-sm">Fügen Sie Ihre erste Speise oben hinzu!</div>
</div>
{{end}}

<script>
function toggleEdit(id) {
    const foodItem = document.getElementById('food-' + id);
    const displayDiv = foodItem.querySelector('.food-display');
    const editDiv = foodItem.querySelector('.food-edit');
    
    displayDiv.classList.toggle('hidden');
    editDiv.classList.toggle('hidden');
}
</script>